<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waktu Solat Smart Surau</title>
    <link rel="stylesheet" href="css/style.css"> 
    <style>
        /* CSS Tambahan Khusus untuk Waktu Solat */
        .prayer-container {
            max-width: 400px;
            margin: 20px auto;
            background-color: #ffffff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .prayer-title {
            text-align: center;
            color: #1a73e8; /* Biru seperti admin dashboard anda */
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        .prayer-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
            align-items: center;
        }
        .prayer-item:last-child {
            border-bottom: none;
        }
        .prayer-name {
            font-weight: bold;
            color: #333;
            font-size: 1.1em;
        }
        .prayer-time {
            font-size: 1.2em;
            color: #1a73e8;
        }
        /* Penyerlahan untuk Waktu Seterusnya */
        .highlight {
            background-color: #e6f7ff; /* Warna latar belakang biru muda */
            border-left: 5px solid #1a73e8; /* Garis biru di tepi */
            border-radius: 8px;
            padding: 10px;
            margin: 5px -10px;
        }
    </style>
</head>
<body>

<div class="prayer-container">
    <h2 class="prayer-title">Jadual Waktu Solat Hari Ini</h2>
    <div id="waktu-solat-list">
        <p style="text-align: center;">Memuatkan waktu solat...</p>
    </div>
    <p style="text-align: center; font-size: 0.8em; margin-top: 20px; color: #666;">
        *Data ini adalah contoh. Gantikan dengan API Waktu Solat sebenar.
    </p>
    <a href="index.html" style="display: block; text-align: center; margin-top: 20px; color: #1a73e8;">← Kembali ke Menu</a>
</div>

<script>
    // Konfigurasi API
const KOD_ZON_ANDA = "WLY01"; // <<< GANTI DENGAN KOD ZON YANG ANDA PILIH (Cth: WLY01)
const listContainer = document.getElementById('waktu-solat-list');

// Kod dalam waktusolat.html
// ...
async function dapatkanWaktuSolatSebenar() {
    const hariIni = new Date();
    const tarikhHariIni = hariIni.toISOString().slice(0, 10);
    
    // API ALTERNATIF: Gantikan keseluruhan baris apiUrl dengan yang di bawah
    const apiUrl = `https://apimosque.azurewebsites.net/api/v1/prayerTime/${KOD_ZON_ANDA}/${tarikhHariIni}`;

    try {
        listContainer.innerHTML = '<p style="text-align: center; color: #1a73e8;">Mengambil waktu solat dari pelayan...</p>';
        
        const response = await fetch(apiUrl);
        
        if (!response.ok) {
            // Jika status HTTP bukan 200 OK
            throw new Error(`Ralat HTTP! Status: ${response.status}`);
        }
        
        const dataAPI = await response.json();

        if (dataAPI.status === 'ok' && dataAPI.data) {
            
            // Proses data yang diterima ke dalam format yang kita perlukan
            // Nama dalam API: imsak, subuh, syuruk, zuhur, asar, maghrib, isyak
            const dataWaktuSolat = [
                { nama: "Imsak", waktu: dataAPI.data.imsak },
                { nama: "Subuh", waktu: dataAPI.data.subuh },
                { nama: "Syuruk", waktu: dataAPI.data.syuruk },
                { nama: "Zuhur", waktu: dataAPI.data.zuhur },
                { nama: "Asar", waktu: dataAPI.data.asar },
                { nama: "Maghrib", waktu: dataAPI.data.maghrib },
                { nama: "Isyak", waktu: dataAPI.data.isyak }
            ];

            // Paparkan data sebenar
            paparkanWaktuSolat(dataWaktuSolat);

        } else {
             throw new Error('Data API tidak sah atau tidak lengkap.');
        }

    } catch (error) {
        console.error("Ralat Waktu Solat:", error);
        listContainer.innerHTML = `<p style="text-align: center; color: red;">❌ Gagal memuatkan waktu solat. Sila semak sambungan internet atau Kod Zon (${KOD_ZON_ANDA}).</p>`;
    }
}

// ----------------------------------------------------------------------
// FUNGSI PAPARAN (Kekal sama, tetapi kini menggunakan data sebenar)
// ----------------------------------------------------------------------

function paparkanWaktuSolat(data) {
    listContainer.innerHTML = ''; 
    const masaSemasa = dapatkanMasaSemasa(); 
    let waktuSeterusnyaDitemui = false;

    data.forEach(solat => {
        const div = document.createElement('div');
        div.classList.add('prayer-item');

        let waktu = solat.waktu;
        let nama = solat.nama;

        // Logik penyerlahan untuk waktu solat fardhu seterusnya
        if (nama !== 'Imsak' && nama !== 'Syuruk' && !waktuSeterusnyaDitemui && waktuLebihBesar(waktu, masaSemasa)) {
            div.classList.add('highlight');
            waktuSeterusnyaDitemui = true;
        }

        div.innerHTML = `
            <span class="prayer-name">${nama}</span>
            <span class="prayer-time">${waktu}</span>
        `;
        listContainer.appendChild(div);
    });

    // Jika waktu seterusnya tidak ditemui (bermakna sudah Isyak), serlahkan Subuh/Imsak hari esok
    if (!waktuSeterusnyaDitemui) {
        const firstItem = listContainer.querySelector('.prayer-item');
        if (firstItem) {
            firstItem.classList.add('highlight');
        }
    }
}

// Fungsi Pembantu JS untuk mendapatkan masa dalam format "HH:MM"
function dapatkanMasaSemasa() {
    const date = new Date();
    // Tambah 8 jam untuk GMT+8 (Jika anda tidak menjalankan kod ini di Malaysia)
    // const date = new Date(new Date().getTime() + (8 * 60 * 60 * 1000)); 
    const hours = String(date.getHours()).padStart(2, '0');
    const minutes = String(date.getMinutes()).padStart(2, '0');
    return `${hours}:${minutes}`;
}

// Fungsi untuk membandingkan masa
function waktuLebihBesar(waktuA, waktuB) {
    return waktuA.localeCompare(waktuB) > 0;
}


// MULA APLIKASI: Panggil fungsi untuk memuatkan waktu solat sebenar
dapatkanWaktuSolatSebenar();
</script>

</body>
</html>
